---
import Chart from 'chart.js/auto';
import 'chartjs-adapter-moment';

const { id, commits } = Astro.props;
---

<canvas {id}></canvas>

<script>
const commits = {commits};
const data = commits.map((commit) => {
  return {
    x: commit.datetime,
    y: commit.stats.notWithin
  }
});

new Chart.default(document.getElementById('{id}'), {
  type: 'line',
  data: {
    datasets: [{
      data,
      cubicInterpolationMode: "monotone",
      fill: true,
    }]
  },
  options: {
    plugins: {
      legend: {
        display: false
      },
    },
    scales: {
      x: {
        type: 'time',
        max: new Date(),
        time: {
          displayFormats: {
            month: 'MMM YYYY'
          }
        }
      },
      y: {
        beginAtZero: true,
        ticks: {
          precision: 0
        }
      }
    }
  }
});
</script>